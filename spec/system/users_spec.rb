require 'rails_helper'

RSpec.describe "Users", type: :system do
  before do
    driven_by(:rack_test)
  end

  describe 'Deviseの認証機能' do
    context 'ユーザー登録' do
      it '有効な情報でユーザーを作成できる' do
        # トップページ → 新規登録ページ → メール・パスワード入力 → 登録完了 → マイページ表示
      end

      it '重複するメールアドレスでは作成できない' do
        # 既存ユーザー作成 → 新規登録ページ → 同じメール入力 → エラーメッセージ表示
      end

      it '無効な情報では登録できない' do
        # 新規登録ページ → 無効なメール・短いパスワード入力 → バリデーションエラー表示
      end
    end

    context 'ログイン機能' do
      it '正しい認証情報でログインできる' do
        # ユーザー作成 → ログインページ → 正しい情報入力 → ログイン成功 → マイページ表示
      end

      it '間違った認証情報ではログインできない' do
        # ユーザー作成 → ログインページ → 間違った情報入力 → エラーメッセージ表示
      end

      it 'ログアウトが正しく動作する' do
        # ログイン → マイページ → ログアウトボタンクリック → トップページ遷移
      end
    end

    context 'パスワードリセット機能' do
      it 'パスワードリセットリンクを送信できる' do
        # ユーザー作成 → パスワードリセットページ → メール入力 → 送信完了メッセージ表示
      end

      it '有効なトークンでパスワードを変更できる' do
        # パスワードリセット → トークン付きリンク → 新パスワード入力 → 変更完了
      end

      it '無効なトークンではパスワード変更できない' do
        # 無効なトークンでアクセス → エラーメッセージ表示
      end
    end

    context 'アカウント管理' do
      it 'プロフィール情報を編集できる' do
        # ログイン → アカウント編集ページ → 情報変更 → 保存 → 変更内容反映確認
      end

      it 'アカウントを削除できる' do
        # ログイン → アカウント削除 → 確認画面 → 削除実行 → トップページ遷移
      end
    end
  end
end
