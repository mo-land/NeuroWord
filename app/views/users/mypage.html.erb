<% breadcrumb :mypage %>
<h1 class="text-2xl font-bold text-left p-6"><%= t('.title') %></h1>
<div class="md:justify-self-start">
  <div class="max-w-3xl mx-auto px-4">

    <%= turbo_frame_tag current_user do %>
      <%= render "profile" %>
    <% end %>
  </div>
</div>

<!-- name of each tab group should be unique -->
<div class="tabs tabs-lift mt-3 p-4">
  <%= radio_button_tag 'my_tabs_3', 'user_questions', @current_tab == 'user_questions',
                     class: 'tab',
                     aria: { label: t('.user_questions') } %>
  <div class="tab-content bg-base-100 border-base-300 p-6">
    <div class="alert alert-info mb-4">
      <span>※ お気に入りボタンを押すと、現在のタブから移動する場合があります。（今後のアップデートで改善予定です。）</span>
    </div>
    <%= render 'user_questions' %>
  </div>

  <%= radio_button_tag 'my_tabs_3', 'user_lists', @current_tab == 'user_lists',
                    class: 'tab',
                    aria: { label: t('.user_lists') } %>
  <div class="tab-content bg-base-100 border-base-300 p-6" data-controller="list-selector">
    <div class="alert alert-info mb-4">
      <span>※ お気に入りボタンを押すと、現在のタブから移動する場合があります。（今後のアップデートで改善予定です。）</span>
    </div>
    <div class="lg:flex gap-4">
      <div id="list_selector_container" class="mb-4">
        <%= render "list_selector", lists: @lists, selected_list_id: @list.id %>
      </div>

    <div class="flex gap-4">
      <div data-controller="list-modal" data-action="turbo:submit-end->list-modal#handleSubmitEnd" class="<%= 'hidden' if @list.is_favorite %>">
        <button class="btn btn-outline btn-accent lg:mt-7" onclick="edit_list_modal.showModal()" data-list-selector-target="editLink">リスト名変更</button>
        <dialog id="edit_list_modal" class="modal modal-bottom sm:modal-middle" data-list-modal-target="dialog">
          <div class="modal-box">
            <%= turbo_frame_tag "edit_list", src: edit_list_path(@list), data: { list_modal_target: "frame" } do %>
              <p>読み込み中...</p>
            <% end %>
          </div>
          <form method="dialog" class="modal-backdrop">
            <button>close</button>
          </form>
        </dialog>
      </div>
      
      <div data-controller="list-modal" data-action="turbo:submit-end->list-modal#handleSubmitEnd">
        <button class="btn btn-primary lg:mt-7" onclick="my_modal_5.showModal()">新規リスト作成</button>
        <dialog id="my_modal_5" class="modal modal-bottom sm:modal-middle" data-list-modal-target="dialog">
          <div class="modal-box">
            <%= turbo_frame_tag "new_list", src: new_list_path, data: { list_modal_target: "frame" } do %>
              <p>読み込み中...</p>
            <% end %>
          </div>
          <form method="dialog" class="modal-backdrop">
            <button>close</button>
          </form>
        </dialog>
      </div>
    </div>
    </div>

    <%= turbo_frame_tag "list_questions" do %>
      <%= render partial: "users/list_questions", locals: { list_questions: @list_questions } %>
    <% end %>
  </div>

  <%= radio_button_tag 'my_tabs_3', 'game_records', @current_tab == 'game_records',
                     class: 'tab',
                     aria: { label: t('.game_records') } %>
  <div class="tab-content bg-base-100 border-base-300 p-6">
    <ul class="list bg-base-100 rounded-box shadow-md">
        <!--%= render 'game_records/game_records' %-->
        <% if @game_records.present? %>
          <div class="alert alert-info mb-4">
            <span>※ お気に入りボタンを押すと、現在のタブから移動する場合があります。（今後のアップデートで改善予定です。）</span>
          </div>
          <%= paginate @game_records, param_name: :game_records_page, params: { tab: 'game_records' } %>
            <%= render 'game_records/game_record' %>
          <div class="p-6">
            <%= paginate @game_records, param_name: :game_records_page, params: { tab: 'game_records' } %>
          </div>
        <% else %>
          <div class="m-8">履歴がありません</div>
        <% end %>
    </ul>
  </div>
</div>
