<!--  app/views/questions/show.html.erb  -->
<div class="container mx-auto pt-5 px-4">
  <% breadcrumb :questions_show, @question %>
  <div class="mb-3 grid grid-cols-1 lg:grid-cols-8">
    <div class="lg:col-start-2 lg:col-span-6">
      <!-- „Éò„ÉÉ„ÉÄ„ÉºÈÉ®ÂàÜ -->
       <!-- „Éò„ÉÉ„ÉÄ„ÉºÈÉ®ÂàÜ -->
        <div class="card-body shadow-md">
          <div class="flex justify-between items-start gap-4 mb-4">
            <div class="flex-1">
              <div class="lg:flex gap-2 items-center">
                <% if has_incompleted_requests?(@question) %>
                  <%= render 'requests/incompleted_request_btn', question: @question %>
                <% end %>
                <h1 class="text-3xl font-bold mb-2"><%= @question.title %></h1>
              </div>
              <%= render 'shared/category_and_tags' %>

              <p class="text-lg text-base-content/70 mb-4"><%= @question.description %></p>

              <div class="text-sm text-base-content/60 flex justify-between items-center">
                <span>
                  by <%= @question.user.name %> - 
                  <%= @question.created_at.strftime("%Y/%m/%d %H:%M") %>
                </span>
              </div>
            </div>
            <div class="flex flex-col gap-2">
              <!-- „Ç∑„Çß„Ç¢„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="card-title justify-end">
                  <div class="flex flex-wrap justify-center gap-4">
                    <div class="flex items-center gap-2 lg:gap-4">
                      <%= render 'shared/favorite_btn' %>
                       <% if current_user && current_user.own?(@question) %>
                        <!-- Twitter/X „Ç∑„Çß„Ç¢ -->
                        <%= link_to "https://twitter.com/intent/tweet?text=#{CGI.escape("NeuroWord„Åß„Äå#{@question.title}„Äç„Çí‰Ωú„Å£„Åü„ÇàÔºÅ\nÊåëÊà¶„Åó„Å¶„Åø„Å¶„Å≠üôå\n\n#‰ª≤ÈñìË®ÄËëâÊé¢„Åó #ÂçòË™û„Ç≤„Éº„É†")}&url=#{CGI.escape("#{request.base_url}/games/#{@question.id}?from=creator")}",
                                    target: "_blank",
                                    class: "btn btn-square btn-sm lg:btn-md btn-neutral shadow-sm flex items-center justify-center" do %>
                        <i class="fab fa-x-twitter"></i>
                      <% end %>
                    </div>
                  </div>
                </div>
                <%= link_to edit_question_path(@question), id: "button-edit-#{@question.id}",
                            class: "btn btn-outline btn-accent btn-sm lg:btn-md shadow-sm" do %>
                  <i class="fas fa-edit mr-2"></i>
                  ÂïèÈ°åÂÜÖÂÆπ„ÇíÁ∑®ÈõÜ
                <% end %>
                <%= link_to question_path(@question), id: "button-delete-#{@question.id}",
                            class: "btn btn-outline btn-error btn-sm lg:btn-md shadow-sm",
                            data: { turbo_method: :delete, turbo_confirm: t('defaults.delete_confirm') }  do %>
                  <i class="fas fa-trash mr-2"></i>
                  „Åì„ÅÆÂïèÈ°å„ÇíÂâäÈô§
                <% end %>
              <% else %>
                <%= render 'requests/request_btn', question: @question %>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
      <!-- „Ç´„Éº„ÉâÂà∂ÈôêÊÉÖÂ†± -->
        <% if current_user && current_user.own?(@question) %>
          <%= render "card_sets/card_limit_info", question: @question %>
        <% end %>
        </div>

      <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 mt-8">
        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
        <div class="lg:col-span-2">
          <div class="card bg-base-100 shadow-lg">
            <div class="card-body">
            <div class="flex justify-between items-center">
              <h1 class="text-3xl font-bold">„Ç´„Éº„Éâ„Çª„ÉÉ„Éà‰∏ÄË¶ß</h1>
            </div>
              <% if current_user && current_user.own?(@question) %>
                <div class="my-2">
                  <% remaining_count = @question.remaining_cards_count %>
                  <% if remaining_count > 1 %>
                    <%= link_to new_question_card_set_path(@question),
                                class: "btn btn-primary shadow-sm" do %>
                      <i class="fas fa-plus mr-2"></i>
                      Êñ∞„Åó„ÅÑ„Ç´„Éº„Éâ„Çª„ÉÉ„Éà„ÇíËøΩÂä†
                    <% end %>
                  <% else %>
                    <button class="btn btn-disabled btn-block">
                      <i class="fas fa-lock mr-2"></i>
                      „Ç´„Éº„ÉâÊï∞‰∏äÈôê„Å´ÈÅî„Åó„Åæ„Åó„Åü
                    </button>
                  <% end %>
                </div>
              <% end %>

            <!-- Ëµ∑ÁÇπË™û„ÉªÈñ¢ÈÄ£Ë™û„É™„Çπ„Éà -->
            <div class="space-y-4">
              <% @card_sets.each do |card_set| %>
                <%= render 'card_sets/card_set', card_set: card_set, question: @question, show_actions: true %>
              <% end %>

              <% if @card_sets.empty? %>
                <div class="text-center py-12">
                  <div class="alert alert-warning">
                    <span>Ëµ∑ÁÇπË™û„Åå„Åæ„Å†ÁôªÈå≤„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì</span>
                  </div>
                </div>
              <% end %>
            </div>

            </div>
          </div>
        </div>

        <!-- „Çµ„Ç§„Éâ„Éê„Éº -->
        <div class="lg:col-span-1">
          <!-- „Ç≤„Éº„É†ÈñãÂßã„Éú„Çø„É≥ -->
          <%= render "questions/game_section", question: @question %>

          <!-- Áµ±Ë®àÊÉÖÂ†± -->
          <%= render "questions/stats_section", question: @question %>

        </div>
      </div>
    </div>
  </div>

  <%# „Ç≥„É°„É≥„Éà„Éï„Ç©„Éº„É† %>
  <div class="grid grid-cols-1 lg:grid-cols-8">
    <div class="lg:col-start-2 lg:col-span-6">
      <table class="table w-full">
        <tbody id="table-comment">
          <%# „Ç≥„É°„É≥„Éà‰∏ÄË¶ß %>
        </tbody>
      </table>
    </div>
  </div>
</div>